<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>æ°§æ°”å®éªŒå®¤åˆ¶å–ä¸æ€§è´¨å­¦ä¹ å°æ¸¸æˆ</title>
	<style>
		* {
			box-sizing: border-box;
			margin: 0;
			padding: 0;
			font-family: 'Microsoft YaHei', sans-serif;
		}
		
		body {
			background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%);
			color: #333;
			min-height: 100vh;
			padding: 20px;
		}
		
		.container {
			max-width: 800px;
			margin: 0 auto;
			background-color: rgba(255, 255, 255, 0.9);
			border-radius: 15px;
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
			padding: 30px;
			position: relative;
			overflow: hidden;
		}
		
		h1 {
			text-align: center;
			color: #0277bd;
			margin-bottom: 20px;
			text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
		}
		
		.intro {
			text-align: center;
			margin-bottom: 30px;
			line-height: 1.6;
		}
		
		.game-area {
			display: none;
		}
		
		.active {
			display: block;
		}
		
		.level-title {
			font-size: 1.5rem;
			color: #01579b;
			margin-bottom: 20px;
			text-align: center;
		}
		
		.question {
			background-color: #e1f5fe;
			padding: 20px;
			border-radius: 10px;
			margin-bottom: 20px;
			border-left: 5px solid #0288d1;
		}
		
		.options {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
			gap: 15px;
			margin-bottom: 20px;
		}
		
		.option {
			background-color: #f5f5f5;
			padding: 15px;
			border-radius: 8px;
			cursor: pointer;
			transition: all 0.3s;
			text-align: center;
			border: 2px solid #e0e0e0;
			position: relative;
		}
		
		.option:hover {
			background-color: #e3f2fd;
			transform: translateY(-3px);
			box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1);
		}
		
		.option.selected {
			background-color: #bbdefb;
			border-color: #2196f3;
			color: #01579b;
			font-weight: bold;
		}
		
		.option.correct {
			background-color: #c8e6c9;
			border-color: #4caf50;
		}
		
		.option.wrong {
			background-color: #ffcdd2;
			border-color: #f44336;
		}
		
		.sortable-list {
			list-style-type: none;
			margin-bottom: 20px;
		}
		
		.sortable-item {
			background-color: #f5f5f5;
			padding: 15px;
			margin-bottom: 10px;
			border-radius: 8px;
			cursor: move;
			border-left: 5px solid #ff9800;
			transition: all 0.3s;
			display: flex;
			align-items: center;
		}
		
		.step-number {
			display: inline-block;
			width: 30px;
			height: 30px;
			background-color: #0288d1;
			color: white;
			border-radius: 50%;
			text-align: center;
			line-height: 30px;
			margin-right: 15px;
			font-weight: bold;
		}
		
		.sortable-item:hover {
			background-color: #fff3e0;
		}
		
		.sortable-item.dragging {
			opacity: 0.6;
			transform: scale(1.02);
		}
		
		.true-false-options {
			display: flex;
			justify-content: center;
			gap: 20px;
			margin-bottom: 20px;
		}
		
		.true-false-btn {
			padding: 12px 30px;
			border-radius: 8px;
			cursor: pointer;
			font-size: 1.1rem;
			font-weight: bold;
			transition: all 0.3s;
			border: none;
		}
		
		.true-btn {
			background-color: #c8e6c9;
			color: #2e7d32;
		}
		
		.false-btn {
			background-color: #ffcdd2;
			color: #c62828;
		}
		
		.true-false-btn:hover {
			transform: translateY(-3px);
			box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1);
		}
		
		.true-false-btn.selected {
			transform: scale(1.05);
			box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
			background-color: #0288d1;
			color: white;
		}
		
		.btn {
			display: block;
			margin: 20px auto;
			padding: 12px 30px;
			background-color: #0288d1;
			color: white;
			border: none;
			border-radius: 8px;
			font-size: 1.1rem;
			cursor: pointer;
			transition: all 0.3s;
		}
		
		.btn:hover {
			background-color: #0277bd;
			transform: translateY(-3px);
			box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1);
		}
		
		.btn:disabled {
			background-color: #b0bec5;
			cursor: not-allowed;
			transform: none;
			box-shadow: none;
		}
		
		.feedback {
			text-align: center;
			padding: 15px;
			border-radius: 8px;
			margin-bottom: 20px;
			font-weight: bold;
			display: none;
		}
		
		.correct-feedback {
			background-color: #e8f5e9;
			color: #2e7d32;
			border: 2px solid #4caf50;
		}
		
		.wrong-feedback {
			background-color: #ffebee;
			color: #c62828;
			border: 2px solid #f44336;
		}
		
		.score {
			text-align: center;
			font-size: 1.2rem;
			margin-bottom: 20px;
			color: #01579b;
		}
		
		.level-indicator {
			display: flex;
			justify-content: center;
			margin-bottom: 20px;
		}
		
		.level-dot {
			width: 12px;
			height: 12px;
			border-radius: 50%;
			background-color: #b0bec5;
			margin: 0 5px;
		}
		
		.level-dot.active {
			background-color: #0288d1;
		}
		
		.completion-screen {
			text-align: center;
			display: none;
		}
		
		.completion-screen h2 {
			color: #0277bd;
			margin-bottom: 20px;
		}
		
		.completion-screen p {
			margin-bottom: 20px;
			font-size: 1.1rem;
		}
		
		.restart-btn {
			background-color: #4caf50;
		}
		
		.restart-btn:hover {
			background-color: #43a047;
		}
		
		.oxygen-molecule {
			position: absolute;
			font-size: 24px;
			opacity: 0.1;
			z-index: -1;
		}
		
		@keyframes float {
			0% { transform: translateY(0) rotate(0deg); }
			50% { transform: translateY(-10px) rotate(5deg); }
			100% { transform: translateY(0) rotate(0deg); }
		}
		
		.floating {
			animation: float 5s ease-in-out infinite;
		}
		
		.sound-toggle {
			position: absolute;
			top: 20px;
			right: 20px;
			background: none;
			border: none;
			font-size: 1.5rem;
			cursor: pointer;
			color: #0277bd;
		}
		
		.hint {
			text-align: center;
			font-style: italic;
			color: #757575;
			margin-bottom: 15px;
		}
		
		.option-number {
			position: absolute;
			top: -8px;
			right: -8px;
			width: 24px;
			height: 24px;
			background-color: #ff9800;
			color: white;
			border-radius: 50%;
			font-size: 0.8rem;
			display: flex;
			align-items: center;
			justify-content: center;
			font-weight: bold;
			display: none;
		}
		
		.selected .option-number {
			display: flex;
		}
		
		.step-item {
			background-color: #e1f5fe;
			padding: 15px;
			margin-bottom: 10px;
			border-radius: 8px;
			cursor: pointer;
			transition: all 0.3s;
			border-left: 5px solid #0288d1;
			display: flex;
			align-items: center;
		}
		
		.step-item.selected {
			background-color: #bbdefb;
			border-color: #2196f3;
			color: #01579b;
			font-weight: bold;
		}
		
		.step-item .step-number {
			background-color: #0288d1;
		}
		
		.step-item.selected .step-number {
			background-color: #2196f3;
		}
	</style>
</head>
<body>
	<div class="container">
		<button id="sound-toggle" class="sound-toggle" title="åˆ‡æ¢éŸ³æ•ˆ">ğŸ”Š</button>
		
		<h1>æ°§æ°”å®éªŒå®¤åˆ¶å–ä¸æ€§è´¨å­¦ä¹ å°æ¸¸æˆ</h1>
		
		<div class="intro">
			<p>æ¬¢è¿æ¥åˆ°æ°§æ°”å®éªŒå®¤åˆ¶å–ä¸æ€§è´¨å­¦ä¹ å°æ¸¸æˆï¼</p>
			<p>é€šè¿‡ä¸‰ä¸ªå…³å¡ï¼Œå·©å›ºä½ å¯¹æ°§æ°”å®éªŒå®¤åˆ¶å–ä¸æ€§è´¨çš„çŸ¥è¯†ã€‚</p>
			<p>æ¯ä¸ªå…³å¡å®Œæˆåï¼Œç‚¹å‡»"ä¸‹ä¸€å…³"ç»§ç»­ã€‚</p>
		</div>
		
		<div class="level-indicator">
			<div class="level-dot active" data-level="1"></div>
			<div class="level-dot" data-level="2"></div>
			<div class="level-dot" data-level="3"></div>
		</div>
		
		<div class="score">å¾—åˆ†: <span id="score-value">0</span>/3</div>
		
		<!-- å…³å¡1: å®éªŒç”¨å“é€‰æ‹© -->
		<div id="level1" class="game-area active">
			<div class="level-title">å…³å¡1: å®éªŒç”¨å“é€‰æ‹©</div>
			<div class="question">
				<p>è¯·é€‰æ‹©å®éªŒå®¤åˆ¶å–æ°§æ°”æ‰€éœ€çš„å®éªŒç”¨å“ï¼š</p>
				<p class="hint">æç¤ºï¼šç‚¹å‡»ç‰©å“å¯ä»¥é€‰ä¸­æˆ–å–æ¶ˆé€‰ä¸­ï¼Œé€‰ä¸­çš„ç‰©å“ä¼šæ˜¾ç¤ºç¼–å·</p>
			</div>
			<div class="options" id="equipment-options">
				<div class="option" data-correct="true">
					<span class="option-number"></span>
					é«˜é”°é…¸é’¾
				</div>
				<div class="option" data-correct="true">
					<span class="option-number"></span>
					è¯•ç®¡
				</div>
				<div class="option" data-correct="true">
					<span class="option-number"></span>
					é…’ç²¾ç¯
				</div>
				<div class="option" data-correct="false">
					<span class="option-number"></span>
					çƒ§æ¯
				</div>
				<div class="option" data-correct="true">
					<span class="option-number"></span>
					é“æ¶å°
				</div>
				<div class="option" data-correct="false">
					<span class="option-number"></span>
					æ¼æ–—
				</div>
				<div class="option" data-correct="true">
					<span class="option-number"></span>
					æ°´æ§½
				</div>
				<div class="option" data-correct="true">
					<span class="option-number"></span>
					ç»ç’ƒå¯¼ç®¡
				</div>
				<div class="option" data-correct="true">
					<span class="option-number"></span>
					ä¹³èƒ¶ç®¡
				</div>
				<div class="option" data-correct="true">
					<span class="option-number"></span>
					ç»ç’ƒç‰‡
				</div>
				<div class="option" data-correct="true">
					<span class="option-number"></span>
					é›†æ°”ç“¶
				</div>
				<div class="option" data-correct="true">
					<span class="option-number"></span>
					æ£‰èŠ±
				</div>
			</div>
			<button id="check-level1" class="btn">æ£€æŸ¥ç­”æ¡ˆ</button>
			<div id="feedback-level1" class="feedback"></div>
			<button id="next-level1" class="btn" disabled>ä¸‹ä¸€å…³</button>
		</div>
		
		<!-- å…³å¡2: å®éªŒæ­¥éª¤æ’åº -->
		<div id="level2" class="game-area">
			<div class="level-title">å…³å¡2: å®éªŒæ­¥éª¤æ’åº</div>
			<div class="question">
				<p>è¯·æŒ‰æ­£ç¡®é¡ºåºç‚¹å‡»å®éªŒæ­¥éª¤ï¼š</p>
				<p class="hint">æç¤ºï¼šç‚¹å‡»æ­¥éª¤è¿›è¡Œæ’åºï¼Œé€‰ä¸­çš„æ­¥éª¤ä¼šæ˜¾ç¤ºç¼–å·å’Œæ”¹å˜é¢œè‰²</p>
			</div>
			<div id="steps-container">
				<!-- æ­¥éª¤å°†åœ¨JSä¸­åŠ¨æ€ç”Ÿæˆå¹¶æ‰“ä¹±é¡ºåº -->
			</div>
			<button id="check-level2" class="btn">æ£€æŸ¥é¡ºåº</button>
			<div id="feedback-level2" class="feedback"></div>
			<button id="next-level2" class="btn" disabled>ä¸‹ä¸€å…³</button>
		</div>
		
		<!-- å…³å¡3: æ˜“é”™ç‚¹åˆ¤æ–­ -->
		<div id="level3" class="game-area">
			<div class="level-title">å…³å¡3: æ˜“é”™ç‚¹åˆ¤æ–­</div>
			<div class="question">
				<p id="true-false-question">è¯·åˆ¤æ–­ä¸‹åˆ—è¯´æ³•æ˜¯å¦æ­£ç¡®ï¼š</p>
				<p class="hint">æç¤ºï¼šç‚¹å‡»å·²é€‰ä¸­çš„æŒ‰é’®å¯ä»¥å–æ¶ˆé€‰æ‹©</p>
			</div>
			<div class="true-false-options">
				<button class="true-false-btn true-btn">æ­£ç¡®</button>
				<button class="true-false-btn false-btn">é”™è¯¯</button>
			</div>
			<button id="check-level3" class="btn">æ£€æŸ¥ç­”æ¡ˆ</button>
			<div id="feedback-level3" class="feedback"></div>
			<button id="next-level3" class="btn" disabled>æŸ¥çœ‹ç»“æœ</button>
		</div>
		
		<!-- å®Œæˆç•Œé¢ -->
		<div id="completion-screen" class="completion-screen">
			<h2>æ­å–œä½ å®Œæˆæ‰€æœ‰å…³å¡ï¼</h2>
			<p>ä½ çš„æœ€ç»ˆå¾—åˆ†æ˜¯: <span id="final-score">0</span>/3</p>
			<p id="completion-message"></p>
			<button id="restart-btn" class="btn restart-btn">é‡æ–°å¼€å§‹</button>
		</div>
	</div>

	<script>
		// å½“å‰å…³å¡å’Œå¾—åˆ†
		let currentLevel = 1;
		let score = 0;
		let soundEnabled = true;
		
		// å…³å¡3çš„é—®é¢˜å’Œç­”æ¡ˆ
		const trueFalseQuestions = [
			{
				question: "åˆ¶å–æ°§æ°”æ—¶ï¼Œè¯•ç®¡å£åº”ç•¥å‘ä¸Šå€¾æ–œã€‚",
				answer: false,
				explanation: "é”™è¯¯ã€‚è¯•ç®¡å£åº”ç•¥å‘ä¸‹å€¾æ–œï¼Œé˜²æ­¢å†·å‡æ°´å€’æµç‚¸è£‚è¯•ç®¡ã€‚"
			},
			{
				question: "å®éªŒç»“æŸåï¼Œåº”å…ˆç†„ç­é…’ç²¾ç¯ï¼Œå†ç§»å‡ºå¯¼ç®¡ã€‚",
				answer: false,
				explanation: "é”™è¯¯ã€‚åº”å…ˆç§»å‡ºå¯¼ç®¡ï¼Œå†ç†„ç­é…’ç²¾ç¯ï¼Œé˜²æ­¢æ°´æ§½ä¸­çš„æ°´å€’å¸è¿›å…¥è¯•ç®¡å¯¼è‡´è¯•ç®¡ç‚¸è£‚ã€‚"
			},
			{
				question: "é“ä¸åœ¨æ°§æ°”ä¸­ç‡ƒçƒ§æ—¶ï¼Œé›†æ°”ç“¶åº•éƒ¨éœ€é¢„å…ˆè£…å°‘é‡æ°´æˆ–é“ºä¸€å±‚ç»†æ²™ã€‚",
				answer: true,
				explanation: "æ­£ç¡®ã€‚é˜²æ­¢é«˜æ¸©ç”Ÿæˆç‰©æº…è½ç‚¸è£‚é›†æ°”ç“¶ã€‚"
			},
			{
				question: "æ°§æ°”å¯ä»¥ç”¨å‘ä¸‹æ’ç©ºæ°”æ³•æ”¶é›†ã€‚",
				answer: false,
				explanation: "é”™è¯¯ã€‚æ°§æ°”å¯†åº¦æ¯”ç©ºæ°”ç•¥å¤§ï¼Œåº”è¯¥ç”¨å‘ä¸Šæ’ç©ºæ°”æ³•æ”¶é›†ã€‚"
			},
			{
				question: "æœ¨ç‚­åœ¨æ°§æ°”ä¸­ç‡ƒçƒ§ç”Ÿæˆèƒ½ä½¿æ¾„æ¸…çŸ³ç°æ°´å˜æµ‘æµŠçš„æ°”ä½“ã€‚",
				answer: true,
				explanation: "æ­£ç¡®ã€‚æœ¨ç‚­åœ¨æ°§æ°”ä¸­ç‡ƒçƒ§ç”ŸæˆäºŒæ°§åŒ–ç¢³ï¼Œèƒ½ä½¿æ¾„æ¸…çŸ³ç°æ°´å˜æµ‘æµŠã€‚"
			}
		];
		
		let currentQuestionIndex = 0;
		
		// å®éªŒå®¤åˆ¶å–æ°§æ°”çš„æ­£ç¡®æ­¥éª¤
		const correctSteps = [
			{ order: 1, text: "æ£€æŸ¥è£…ç½®çš„æ°”å¯†æ€§" },
			{ order: 2, text: "å‘è¯•ç®¡ä¸­è£…å…¥é«˜é”°é…¸é’¾ï¼Œå¹¶åœ¨è¯•ç®¡å£æ”¾ä¸€å›¢æ£‰èŠ±" },
			{ order: 3, text: "å°†è¯•ç®¡å›ºå®šåœ¨é“æ¶å°ä¸Š" },
			{ order: 4, text: "ç‚¹ç‡ƒé…’ç²¾ç¯ï¼Œå…ˆé¢„çƒ­è¯•ç®¡ï¼Œå†å¯¹è¯å“éƒ¨ä½åŠ çƒ­" },
			{ order: 5, text: "å½“å¯¼ç®¡å£æœ‰è¿ç»­å‡åŒ€çš„æ°”æ³¡å†’å‡ºæ—¶ï¼Œå¼€å§‹æ”¶é›†æ°§æ°”" },
			{ order: 6, text: "æ”¶é›†å®Œæ¯•åï¼Œå…ˆå°†å¯¼ç®¡ç§»å‡ºæ°´æ§½" },
			{ order: 7, text: "ç†„ç­é…’ç²¾ç¯ï¼Œå†·å´åæ‹†é™¤è£…ç½®" }
		];
		
		// åˆå§‹åŒ–æ¸¸æˆ
		document.addEventListener('DOMContentLoaded', function() {
			// æ·»åŠ æ¼‚æµ®çš„æ°§æ°”åˆ†å­
			addOxygenMolecules();
			
			// è®¾ç½®éŸ³æ•ˆå¼€å…³
			document.getElementById('sound-toggle').addEventListener('click', function() {
				soundEnabled = !soundEnabled;
				this.textContent = soundEnabled ? 'ğŸ”Š' : 'ğŸ”‡';
				playSound('toggle');
			});
			
			// å…³å¡1: å®éªŒç”¨å“é€‰æ‹©
			setupLevel1();
			
			// å…³å¡2: å®éªŒæ­¥éª¤æ’åº
			setupLevel2();
			
			// å…³å¡3: æ˜“é”™ç‚¹åˆ¤æ–­
			setupLevel3();
			
			// é‡æ–°å¼€å§‹æŒ‰é’®
			document.getElementById('restart-btn').addEventListener('click', restartGame);
		});
		
		// æ’­æ”¾éŸ³æ•ˆ
		function playSound(type) {
			if (!soundEnabled) return;
			
			const audioContext = new (window.AudioContext || window.webkitAudioContext)();
			const oscillator = audioContext.createOscillator();
			const gainNode = audioContext.createGain();
			
			oscillator.connect(gainNode);
			gainNode.connect(audioContext.destination);
			
			switch(type) {
				case 'correct':
					oscillator.frequency.setValueAtTime(880, audioContext.currentTime);
					gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
					gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
					oscillator.start(audioContext.currentTime);
					oscillator.stop(audioContext.currentTime + 0.5);
					break;
				case 'wrong':
					oscillator.frequency.setValueAtTime(220, audioContext.currentTime);
					gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
					gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
					oscillator.start(audioContext.currentTime);
					oscillator.stop(audioContext.currentTime + 0.5);
					break;
				case 'click':
					oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
					gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
					gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
					oscillator.start(audioContext.currentTime);
					oscillator.stop(audioContext.currentTime + 0.1);
					break;
				case 'toggle':
					oscillator.frequency.setValueAtTime(660, audioContext.currentTime);
					gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
					gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
					oscillator.start(audioContext.currentTime);
					oscillator.stop(audioContext.currentTime + 0.2);
					break;
			}
		}
		
		// æ·»åŠ æ¼‚æµ®çš„æ°§æ°”åˆ†å­
		function addOxygenMolecules() {
			const container = document.querySelector('.container');
			for (let i = 0; i < 10; i++) {
				const oxygen = document.createElement('div');
				oxygen.className = 'oxygen-molecule floating';
				oxygen.textContent = 'Oâ‚‚';
				oxygen.style.left = Math.random() * 90 + '%';
				oxygen.style.top = Math.random() * 90 + '%';
				oxygen.style.animationDelay = Math.random() * 5 + 's';
				container.appendChild(oxygen);
			}
		}
		
		// è®¾ç½®å…³å¡1
		function setupLevel1() {
			const options = document.querySelectorAll('#equipment-options .option');
			const checkBtn = document.getElementById('check-level1');
			const nextBtn = document.getElementById('next-level1');
			const feedback = document.getElementById('feedback-level1');
			
			// ä¸ºæŒ‰é’®æ·»åŠ ç‚¹å‡»éŸ³æ•ˆ
			checkBtn.addEventListener('click', function() {
				playSound('click');
			});
			nextBtn.addEventListener('click', function() {
				playSound('click');
			});
			
			let selectedCount = 0;
			
			options.forEach(option => {
				option.addEventListener('click', function() {
					// åˆ‡æ¢é€‰ä¸­çŠ¶æ€
					const wasSelected = this.classList.contains('selected');
					this.classList.toggle('selected');
					// ç§»é™¤ä¹‹å‰çš„ç»“æœæ ‡è®°
					this.classList.remove('correct', 'wrong');
					
					if (this.classList.contains('selected') && !wasSelected) {
						// é€‰ä¸­
						selectedCount++;
						const optionNumber = this.querySelector('.option-number');
						optionNumber.textContent = selectedCount;
					} else if (!this.classList.contains('selected') && wasSelected) {
						// å–æ¶ˆé€‰ä¸­
						selectedCount--;
						// æ›´æ–°å…¶ä»–é€‰é¡¹çš„ç¼–å·
						updateOptionNumbers();
					}
					
					playSound('click');
				});
			});
			
			// æ›´æ–°é€‰é¡¹ç¼–å·çš„å‡½æ•°
			function updateOptionNumbers() {
				let count = 0;
				options.forEach(option => {
					if (option.classList.contains('selected')) {
						count++;
						const optionNumber = option.querySelector('.option-number');
						optionNumber.textContent = count;
					}
				});
				selectedCount = count;
			}
			
			checkBtn.addEventListener('click', function() {
				let allCorrect = true;
				let selectedCorrect = true;
				
				options.forEach(option => {
					const isCorrect = option.getAttribute('data-correct') === 'true';
					const isSelected = option.classList.contains('selected');
					
					if (isCorrect && !isSelected) {
						allCorrect = false;
						option.classList.add('correct');
					} else if (!isCorrect && isSelected) {
						allCorrect = false;
						selectedCorrect = false;
						option.classList.add('wrong');
					} else if (isCorrect && isSelected) {
						option.classList.add('correct');
					}
				});
				
				if (allCorrect && selectedCorrect) {
					feedback.textContent = "æ­å–œä½ ï¼å…¨éƒ¨é€‰æ‹©æ­£ç¡®ï¼";
					feedback.className = "feedback correct-feedback";
					feedback.style.display = "block";
					score++;
					updateScore();
					nextBtn.disabled = false;
					checkBtn.disabled = true;
					playSound('correct');
				} else {
					feedback.textContent = "æœ‰äº›é€‰é¡¹é€‰æ‹©ä¸æ­£ç¡®ï¼Œè¯·æ£€æŸ¥å¹¶é‡è¯•ã€‚";
					feedback.className = "feedback wrong-feedback";
					feedback.style.display = "block";
					playSound('wrong');
				}
			});
			
			nextBtn.addEventListener('click', function() {
				switchLevel(2);
			});
		}
		
		// è®¾ç½®å…³å¡2
		function setupLevel2() {
			const stepsContainer = document.getElementById('steps-container');
			const checkBtn = document.getElementById('check-level2');
			const nextBtn = document.getElementById('next-level2');
			const feedback = document.getElementById('feedback-level2');
			
			// ä¸ºæŒ‰é’®æ·»åŠ ç‚¹å‡»éŸ³æ•ˆ
			checkBtn.addEventListener('click', function() {
				playSound('click');
			});
			nextBtn.addEventListener('click', function() {
				playSound('click');
			});
			
			// å¤åˆ¶å¹¶æ‰“ä¹±æ­¥éª¤é¡ºåº
			const shuffledSteps = [...correctSteps];
			shuffleArray(shuffledSteps);
			
			// å°†æ‰“ä¹±åçš„æ­¥éª¤æ·»åŠ åˆ°å®¹å™¨ä¸­
			shuffledSteps.forEach(step => {
				const stepItem = document.createElement('div');
				stepItem.className = 'step-item';
				stepItem.setAttribute('data-order', step.order);
				
				// æ·»åŠ æ­¥éª¤ç¼–å·å®¹å™¨
				const stepNumber = document.createElement('span');
				stepNumber.className = 'step-number';
				stepNumber.textContent = '?';
				stepItem.appendChild(stepNumber);
				
				// æ·»åŠ æ­¥éª¤æ–‡æœ¬
				const stepText = document.createElement('span');
				stepText.textContent = step.text;
				stepItem.appendChild(stepText);
				
				stepsContainer.appendChild(stepItem);
			});
			
			let selectedSteps = [];
			
			// æ­¥éª¤ç‚¹å‡»äº‹ä»¶
			const stepItems = stepsContainer.querySelectorAll('.step-item');
			stepItems.forEach(stepItem => {
				stepItem.addEventListener('click', function() {
					// å¦‚æœå·²ç»é€‰ä¸­ï¼Œåˆ™å–æ¶ˆé€‰ä¸­
					if (this.classList.contains('selected')) {
						this.classList.remove('selected');
						const order = parseInt(this.getAttribute('data-order'));
						selectedSteps = selectedSteps.filter(step => step !== order);
						
						// æ›´æ–°æ‰€æœ‰æ­¥éª¤çš„ç¼–å·
						updateStepNumbers();
					} else {
						// é€‰ä¸­æ­¥éª¤
						this.classList.add('selected');
						const order = parseInt(this.getAttribute('data-order'));
						selectedSteps.push(order);
						
						// æ›´æ–°æ­¥éª¤ç¼–å·
						const stepNumber = this.querySelector('.step-number');
						stepNumber.textContent = selectedSteps.length;
					}
					
					playSound('click');
				});
			});
			
			// æ›´æ–°æ­¥éª¤ç¼–å·çš„å‡½æ•°
			function updateStepNumbers() {
				selectedSteps = [];
				stepItems.forEach(stepItem => {
					if (stepItem.classList.contains('selected')) {
						const order = parseInt(stepItem.getAttribute('data-order'));
						selectedSteps.push(order);
						const stepNumber = stepItem.querySelector('.step-number');
						stepNumber.textContent = selectedSteps.length;
					} else {
						const stepNumber = stepItem.querySelector('.step-number');
						stepNumber.textContent = '?';
					}
				});
			}
			
			checkBtn.addEventListener('click', function() {
				const correctOrder = [1, 2, 3, 4, 5, 6, 7];
				
				let isCorrect = true;
				if (selectedSteps.length !== correctOrder.length) {
					isCorrect = false;
				} else {
					for (let i = 0; i < selectedSteps.length; i++) {
						if (selectedSteps[i] !== correctOrder[i]) {
							isCorrect = false;
							break;
						}
					}
				}
				
				if (isCorrect) {
					feedback.textContent = "æ­å–œä½ ï¼æ­¥éª¤é¡ºåºå®Œå…¨æ­£ç¡®ï¼";
					feedback.className = "feedback correct-feedback";
					feedback.style.display = "block";
					score++;
					updateScore();
					nextBtn.disabled = false;
					checkBtn.disabled = true;
					playSound('correct');
				} else {
					feedback.textContent = "æ­¥éª¤é¡ºåºä¸æ­£ç¡®ï¼Œè¯·æ£€æŸ¥å¹¶é‡è¯•ã€‚";
					feedback.className = "feedback wrong-feedback";
					feedback.style.display = "block";
					playSound('wrong');
				}
			});
			
			nextBtn.addEventListener('click', function() {
				switchLevel(3);
			});
		}
		
		// è®¾ç½®å…³å¡3
		function setupLevel3() {
			const trueBtn = document.querySelector('.true-btn');
			const falseBtn = document.querySelector('.false-btn');
			const checkBtn = document.getElementById('check-level3');
			const nextBtn = document.getElementById('next-level3');
			const feedback = document.getElementById('feedback-level3');
			const questionElement = document.getElementById('true-false-question');
			
			// ä¸ºæŒ‰é’®æ·»åŠ ç‚¹å‡»éŸ³æ•ˆ
			trueBtn.addEventListener('click', function() {
				playSound('click');
			});
			falseBtn.addEventListener('click', function() {
				playSound('click');
			});
			checkBtn.addEventListener('click', function() {
				playSound('click');
			});
			nextBtn.addEventListener('click', function() {
				playSound('click');
			});
			
			let selectedAnswer = null;
			let answered = false;
			
			// æ˜¾ç¤ºç¬¬ä¸€ä¸ªé—®é¢˜
			showQuestion();
			
			trueBtn.addEventListener('click', function() {
				if (answered) return;
				
				// å¦‚æœå·²ç»é€‰ä¸­äº†trueæŒ‰é’®ï¼Œåˆ™å–æ¶ˆé€‰æ‹©
				if (selectedAnswer === true) {
					selectedAnswer = null;
					trueBtn.classList.remove('selected');
				} else {
					selectedAnswer = true;
					trueBtn.classList.add('selected');
					falseBtn.classList.remove('selected');
				}
			});
			
			falseBtn.addEventListener('click', function() {
				if (answered) return;
				
				// å¦‚æœå·²ç»é€‰ä¸­äº†falseæŒ‰é’®ï¼Œåˆ™å–æ¶ˆé€‰æ‹©
				if (selectedAnswer === false) {
					selectedAnswer = null;
					falseBtn.classList.remove('selected');
				} else {
					selectedAnswer = false;
					falseBtn.classList.add('selected');
					trueBtn.classList.remove('selected');
				}
			});
			
			checkBtn.addEventListener('click', function() {
				if (selectedAnswer === null) {
					feedback.textContent = "è¯·é€‰æ‹©ä¸€ä¸ªç­”æ¡ˆï¼";
					feedback.className = "feedback wrong-feedback";
					feedback.style.display = "block";
					return;
				}
				
				const currentQuestion = trueFalseQuestions[currentQuestionIndex];
				const isCorrect = selectedAnswer === currentQuestion.answer;
				
				if (isCorrect) {
					feedback.textContent = "å›ç­”æ­£ç¡®ï¼" + currentQuestion.explanation;
					feedback.className = "feedback correct-feedback";
					feedback.style.display = "block";
					score++;
					updateScore();
					playSound('correct');
				} else {
					feedback.textContent = "å›ç­”é”™è¯¯ï¼" + currentQuestion.explanation;
					feedback.className = "feedback wrong-feedback";
					feedback.style.display = "block";
					playSound('wrong');
				}
				
				answered = true;
				checkBtn.disabled = true;
				
				// å¦‚æœä¸æ˜¯æœ€åä¸€ä¸ªé—®é¢˜ï¼Œå‡†å¤‡ä¸‹ä¸€ä¸ªé—®é¢˜
				if (currentQuestionIndex < trueFalseQuestions.length - 1) {
					setTimeout(() => {
						currentQuestionIndex++;
						showQuestion();
						resetQuestionState();
					}, 2000);
				} else {
					nextBtn.disabled = false;
				}
			});
			
			nextBtn.addEventListener('click', function() {
				showCompletionScreen();
			});
			
			function showQuestion() {
				const question = trueFalseQuestions[currentQuestionIndex];
				questionElement.textContent = "è¯·åˆ¤æ–­ä¸‹åˆ—è¯´æ³•æ˜¯å¦æ­£ç¡®ï¼š" + question.question;
			}
			
			function resetQuestionState() {
				selectedAnswer = null;
				answered = false;
				trueBtn.classList.remove('selected');
				falseBtn.classList.remove('selected');
				feedback.style.display = "none";
				checkBtn.disabled = false;
			}
		}
		
		// è¾…åŠ©å‡½æ•°ï¼šæ‰“ä¹±æ•°ç»„é¡ºåº
		function shuffleArray(array) {
			for (let i = array.length - 1; i > 0; i--) {
				const j = Math.floor(Math.random() * (i + 1));
				[array[i], array[j]] = [array[j], array[i]];
			}
			return array;
		}
		
		// åˆ‡æ¢å…³å¡
		function switchLevel(level) {
			document.getElementById(`level${currentLevel}`).classList.remove('active');
			document.getElementById(`level${level}`).classList.add('active');
			
			// æ›´æ–°å…³å¡æŒ‡ç¤ºå™¨
			document.querySelectorAll('.level-dot').forEach(dot => {
				dot.classList.remove('active');
				if (parseInt(dot.getAttribute('data-level')) === level) {
					dot.classList.add('active');
				}
			});
			
			currentLevel = level;
		}
		
		// æ›´æ–°å¾—åˆ†
		function updateScore() {
			document.getElementById('score-value').textContent = score;
		}
		
		// æ˜¾ç¤ºå®Œæˆç•Œé¢
		function showCompletionScreen() {
			document.getElementById('level3').classList.remove('active');
			document.getElementById('completion-screen').style.display = 'block';
			document.getElementById('final-score').textContent = score;
			
			let message = "";
			if (score === 3) {
				message = "å¤ªæ£’äº†ï¼ä½ å¯¹æ°§æ°”å®éªŒå®¤åˆ¶å–ä¸æ€§è´¨æŒæ¡å¾—éå¸¸ç‰¢å›ºï¼";
			} else if (score >= 2) {
				message = "ä¸é”™ï¼ä½ å¯¹æ°§æ°”å®éªŒå®¤åˆ¶å–ä¸æ€§è´¨æœ‰è¾ƒå¥½çš„ç†è§£ï¼";
			} else {
				message = "éœ€è¦ç»§ç»­åŠªåŠ›ï¼Œå»ºè®®å›é¡¾ä¸€ä¸‹æ°§æ°”å®éªŒå®¤åˆ¶å–ä¸æ€§è´¨çš„ç›¸å…³çŸ¥è¯†ã€‚";
			}
			
			document.getElementById('completion-message').textContent = message;
		}
		
		// é‡æ–°å¼€å§‹æ¸¸æˆ
		function restartGame() {
			currentLevel = 1;
			score = 0;
			currentQuestionIndex = 0;
			
			// é‡ç½®å…³å¡1
			document.querySelectorAll('#equipment-options .option').forEach(option => {
				option.classList.remove('selected', 'correct', 'wrong');
				const optionNumber = option.querySelector('.option-number');
				optionNumber.textContent = '';
			});
			document.getElementById('check-level1').disabled = false;
			document.getElementById('next-level1').disabled = true;
			document.getElementById('feedback-level1').style.display = 'none';
			
			// é‡ç½®å…³å¡2
			const stepsContainer = document.getElementById('steps-container');
			stepsContainer.innerHTML = '';
			
			// é‡æ–°ç”Ÿæˆå¹¶æ‰“ä¹±æ­¥éª¤
			const shuffledSteps = [...correctSteps];
			shuffleArray(shuffledSteps);
			
			shuffledSteps.forEach(step => {
				const stepItem = document.createElement('div');
				stepItem.className = 'step-item';
				stepItem.setAttribute('data-order', step.order);
				
				// æ·»åŠ æ­¥éª¤ç¼–å·å®¹å™¨
				const stepNumber = document.createElement('span');
				stepNumber.className = 'step-number';
				stepNumber.textContent = '?';
				stepItem.appendChild(stepNumber);
				
				// æ·»åŠ æ­¥éª¤æ–‡æœ¬
				const stepText = document.createElement('span');
				stepText.textContent = step.text;
				stepItem.appendChild(stepText);
				
				stepsContainer.appendChild(stepItem);
			});
			
			// é‡æ–°è®¾ç½®ç‚¹å‡»äº‹ä»¶
			const stepItems = stepsContainer.querySelectorAll('.step-item');
			let selectedSteps = [];
			
			stepItems.forEach(stepItem => {
				stepItem.addEventListener('click', function() {
					// å¦‚æœå·²ç»é€‰ä¸­ï¼Œåˆ™å–æ¶ˆé€‰ä¸­
					if (this.classList.contains('selected')) {
						this.classList.remove('selected');
						const order = parseInt(this.getAttribute('data-order'));
						selectedSteps = selectedSteps.filter(step => step !== order);
						
						// æ›´æ–°æ‰€æœ‰æ­¥éª¤çš„ç¼–å·
						updateStepNumbers();
					} else {
						// é€‰ä¸­æ­¥éª¤
						this.classList.add('selected');
						const order = parseInt(this.getAttribute('data-order'));
						selectedSteps.push(order);
						
						// æ›´æ–°æ­¥éª¤ç¼–å·
						const stepNumber = this.querySelector('.step-number');
						stepNumber.textContent = selectedSteps.length;
					}
					
					playSound('click');
				});
			});
			
			// æ›´æ–°æ­¥éª¤ç¼–å·çš„å‡½æ•°
			function updateStepNumbers() {
				selectedSteps = [];
				stepItems.forEach(stepItem => {
					if (stepItem.classList.contains('selected')) {
						const order = parseInt(stepItem.getAttribute('data-order'));
						selectedSteps.push(order);
						const stepNumber = stepItem.querySelector('.step-number');
						stepNumber.textContent = selectedSteps.length;
					} else {
						const stepNumber = stepItem.querySelector('.step-number');
						stepNumber.textContent = '?';
					}
				});
			}
			
			document.getElementById('check-level2').disabled = false;
			document.getElementById('next-level2').disabled = true;
			document.getElementById('feedback-level2').style.display = 'none';
			
			// é‡ç½®å…³å¡3
			document.querySelector('.true-btn').classList.remove('selected');
			document.querySelector('.false-btn').classList.remove('selected');
			document.getElementById('check-level3').disabled = false;
			document.getElementById('next-level3').disabled = true;
			document.getElementById('feedback-level3').style.display = 'none';
			
			// é‡ç½®å®Œæˆç•Œé¢
			document.getElementById('completion-screen').style.display = 'none';
			
			// åˆ‡æ¢åˆ°ç¬¬ä¸€å…³
			document.querySelectorAll('.game-area').forEach(area => {
				area.classList.remove('active');
			});
			document.getElementById('level1').classList.add('active');
			
			// é‡ç½®å…³å¡æŒ‡ç¤ºå™¨
			document.querySelectorAll('.level-dot').forEach(dot => {
				dot.classList.remove('active');
				if (parseInt(dot.getAttribute('data-level')) === 1) {
					dot.classList.add('active');
				}
			});
			
			// é‡ç½®å¾—åˆ†
			updateScore();
		}
	</script>
</body>
</html>